<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Ronin.jl</title><meta name="title" content="Home · Ronin.jl"/><meta property="og:title" content="Home · Ronin.jl"/><meta property="twitter:title" content="Home · Ronin.jl"/><meta name="description" content="Documentation for Ronin.jl."/><meta property="og:description" content="Documentation for Ronin.jl."/><meta property="twitter:description" content="Documentation for Ronin.jl."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Ronin.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Home</a><ul class="internal"><li><a class="tocitem" href="#Preparing-input-data"><span>Preparing input data</span></a></li><li><a class="tocitem" href="#More-information-about-this-function-is-contained-within-the-docs."><span>More information about this function is contained within the docs.</span></a></li><li><a class="tocitem" href="#Training-a-Random-Forest-Model"><span>Training a Random Forest Model</span></a></li><li><a class="tocitem" href="#Applying-the-trained-model-to-a-radar-scan"><span>Applying the trained model to a radar scan</span></a></li></ul></li><li><a class="tocitem" href="api.html">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/irslushy/Ronin.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/irslushy/Ronin.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Workflow-Walkthrough"><a class="docs-heading-anchor" href="#Basic-Workflow-Walkthrough">Basic Workflow Walkthrough</a><a id="Basic-Workflow-Walkthrough-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Workflow-Walkthrough" title="Permalink"></a></h1><p>RadarQC is a package that utilizes a methodology developed by <a href="https://journals.ametsoc.org/view/journals/aies/aop/AIES-D-23-0064.1/AIES-D-23-0064.1.xml">Dr. Alex DesRosiers and Dr. Michael Bell</a> to remove non-meteorological gates from Doppler radar scans by leveraging machine learning techniques. In its current form, it contains functionality to derive a set of features from input radar data, use these features to train a Random Forest classification model, and apply this model to the raw fields contained within the radar scans. It also has some model evaluation ability. The beginning of this guide will walk through a basic workflow to train a model starting from scratch.  </p><hr/><h2 id="Preparing-input-data"><a class="docs-heading-anchor" href="#Preparing-input-data">Preparing input data</a><a id="Preparing-input-data-1"></a><a class="docs-heading-anchor-permalink" href="#Preparing-input-data" title="Permalink"></a></h2><hr/><p>The first step in the process is to split our data so that some of it may be utilized for model training and the other portion for model testing. It&#39;s important to keep the two sets separate, otherwise the model may overfit. </p><p>The basic requirement here is to have a directory or directories of cfradial scans, and two directories to put training and testing files, respectively. Make sure that no other files are present in these directories. To do this, the <a href="https://github.com/irslushy/RadarQC.jl/blob/52d7f15ddb791bfef4341ff3e9d49fb1fb630049/src/RadarQC.jl#L576-L601"><code>split_training_testing!</code></a> function will be used. For example, if one had two cases of radar data, located in <code>./CASE1/</code> and <code>./CASE2/</code> and wanted to split into <code>./TRAINING</code> and <code>./TESTING</code>, execute the command </p><pre><code class="language-julia hljs">split_training_testing([&quot;./CASE1&quot;, &quot;./CASE2&quot;], &quot;./TRAINING&quot;, &quot;./TESTING&quot;)</code></pre><h2 id="More-information-about-this-function-is-contained-within-the-docs."><a class="docs-heading-anchor" href="#More-information-about-this-function-is-contained-within-the-docs.">More information about this function is contained within the docs.</a><a id="More-information-about-this-function-is-contained-within-the-docs.-1"></a><a class="docs-heading-anchor-permalink" href="#More-information-about-this-function-is-contained-within-the-docs." title="Permalink"></a></h2><p>Now that we have split the input files, we can proceed to calculate the features used to train and test our Random Forest model. Further details are contained within the aforementioned manuscript, but it has been shown that the parameters contained <a href="https://github.com/irslushy/RadarQC.jl/blob/52d7f15ddb791bfef4341ff3e9d49fb1fb630049/MODELS/DesRosiers_Bell_23/config.txt">here</a> are most effective for discriminating between meteorological/non-meteorological gates. For this, we will use the <a href="https://github.com/irslushy/RadarQC.jl/blob/52d7f15ddb791bfef4341ff3e9d49fb1fb630049/src/RadarQC.jl#L27-L95">calculate_features</a> function. Since we are calculating features to <strong>train</strong> a model at this point, we will assume that they have already a human apply QC. To get the most skillful model possible, we will want to remove &quot;easy&quot; cases from the training set, so set <code>REMOVE_LOW_NCP=true</code> and <code>REMOVE_HIGH_PGG=true</code> to ignore data not meeting minimum quality thresholds. It&#39;s also important to specify which variable contained with the input scans has already been QC&#39;ed - in the ELDORA scans, this is <code>VG</code>. <code>missing</code> values must also be removed from the initial training set, so we&#39;ll use a raw variable <code>VV</code> to determine where these gates are located. With that said, one may now invoke </p><pre><code class="language-julia hljs">calculate_features(&quot;./TRAINING&quot;, &quot;./config.txt&quot;, &quot;TRAINING_FEATURES.h5&quot;, true;
                    verbose=true, REMOVE_LOW_NCP = true, REMOVE_HIGH_PGG=true,
                    QC_variable=&quot;VG&quot;, remove_variable=&quot;VV&quot;)</code></pre><p>To use the config file located at <code>./config.txt</code> to output the training features to <code>TRAINING_FEATURES.h5</code>. </p><p>For clarity&#39;s sake, for the testing features this step would be exectued again but changing the input directory and output location. </p><p>This is a somewhat computationally expensive process for large datasets &gt;1000 scans, and so can take over 15 minutes. </p><hr/><h2 id="Training-a-Random-Forest-Model"><a class="docs-heading-anchor" href="#Training-a-Random-Forest-Model">Training a Random Forest Model</a><a id="Training-a-Random-Forest-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Training-a-Random-Forest-Model" title="Permalink"></a></h2><hr/><p>Now that the somewhat arduous process of calculating input features has completed, it&#39;s time to train our model! We&#39;ll use the <strong>training</strong> set for this, which we have previously defined to be located at <code>./TRAINING_FEATURES.h5</code>. Invoke as follows</p><pre><code class="language-julia hljs">train_model(&quot;./TRAINING_FEATURES.h5&quot;, &quot;TRAINED_MODEL.joblib&quot;; verify=true, verify_out=&quot;TRAINING_SET_VERIFICATION.h5&quot;)</code></pre><p>This will train a model based off the information contained within <code>TRAINING_FEATURES.h5</code>, saving it for further use at <code>./TRAINED_MODEL.joblib</code>. The <code>verify</code> keyword arguments means that, once trained, the model will be automatically applied to the training dataset and the predictions will be output, along with the ground truth/correct answers, to the h5 file at <code>TRAINING_SET_VERIFICATION.h5</code>.   </p><hr/><h2 id="Applying-the-trained-model-to-a-radar-scan"><a class="docs-heading-anchor" href="#Applying-the-trained-model-to-a-radar-scan">Applying the trained model to a radar scan</a><a id="Applying-the-trained-model-to-a-radar-scan-1"></a><a class="docs-heading-anchor-permalink" href="#Applying-the-trained-model-to-a-radar-scan" title="Permalink"></a></h2><hr/><p>It&#39;s finally time to begin cleaning radar data! We&#39;ll use the <code>QC_scan</code> function to apply our model to raw moments. Let&#39;s imagine we want to clean the scan located at <code>./cfrad_example_scan</code> using the model we previously trained at <code>TRAINED_MODEL.joblib</code>. By default, this will clean the variables with the names <code>ZZ</code> and <code>VV</code>, though this can be changed by modifying the <code>VARIABLES_TO_QC</code> argument. They will be added to the cfradial file with the names <code>ZZ_QC</code> and <code>VV_QC</code>, respectively, though this suffix can be changed though keyword arguments. Execute as  </p><pre><code class="language-julia hljs">QC_scan(&quot;./cfrad_example_scan&quot;, &quot;./config.txt&quot;, &quot;./TRAINED_MODEL.joblib&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="api.html">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.4.1 on <span class="colophon-date" title="Tuesday 4 June 2024 20:40">Tuesday 4 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
